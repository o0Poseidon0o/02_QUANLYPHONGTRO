version: "3.8"

services:
  # Service 1: Backend
  backend:
    build: ./backend # ⚠️ Lưu ý: Đảm bảo thư mục code của bạn tên là 'backend' (hoặc 'server')
    container_name: quanlynhatro_backend
    restart: always

    # --- [FIX 1] XÓA phần environment viết cứng đi ---
    # Thay bằng env_file để đọc từ file .env
    env_file:
      - ./backend/.env # ⚠️ Đường dẫn trỏ vào nơi chứa file .env
    # -----------------------------------------------

    ports:
      - "5000:5000" # Nên mở port này để dễ test backend độc lập
    networks:
      - app-network

  # Service 2: Frontend
  frontend:
    build: ./fontend # ⚠️ [FIX 2] Bạn viết sai chính tả: 'fontend' -> kiểm tra lại tên thư mục là 'frontend' hay 'client'?
    container_name: quanlynhatro_frontend
    restart: always
    ports:
      - "89:80" # ⚠️ [FIX 3] Nginx mặc định chạy cổng 80, nên map 89:80 (trừ khi bạn đã sửa nginx.conf thành 89)
    depends_on:
      - backend
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
